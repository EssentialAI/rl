
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>[4.0] Multi-Arm Bandit Problem &#8212; Reinforcement Learning Notes</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="_static/brain1.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="[4.1] Epsilon-Greedy" href="epsilon-greedy.html" />
    <link rel="prev" title="Introduction to Probability" href="C1_prob.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Reinforcement Learning Notes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   Preface
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="table_of_contents.html">
   Table of Contents
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="structure.html">
   Structure of this book
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="status.html">
   Book Status
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Introduction.html">
   [1.0] Introduction
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="math_back.html">
   [2.0] Mathematical Background
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="math_back1.html">
     Infinite Series
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="Prob_review.html">
   [3.0] Probability Review
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="C1_prob.html">
     Introduction to Probability
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="current reference internal" href="#">
   [4.0] Multi-Arm Bandit Problem
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="epsilon-greedy.html">
     [4.1] Epsilon-Greedy
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/MAB_Intro.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#explore-exploit-dilemma">
   Explore-Exploit dilemma
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#statistical-approach-towards-choosing-slot-machines">
   Statistical approach towards choosing slot machines.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adaptation">
   Adaptation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#applications-of-explore-exploit-dilemma">
   Applications of Explore-Exploit Dilemma
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="multi-arm-bandit-problem">
<h1>[4.0] Multi-Arm Bandit Problem<a class="headerlink" href="#multi-arm-bandit-problem" title="Permalink to this headline">¶</a></h1>
<p>In this section of the course we get introduced to the explore-exploit dilemma and the Multi-Arm bandit problem.</p>
<div class="section" id="explore-exploit-dilemma">
<h2>Explore-Exploit dilemma<a class="headerlink" href="#explore-exploit-dilemma" title="Permalink to this headline">¶</a></h2>
<p>The Explore-Exploit dilemma can be best understood with the casino example. Let’s say you walk into a casino and find two slot machines. You either win or lose, there is no in between. The reward is either $1 or $0.</p>
<p><span class = 'hital'>At this moment there is no real advantage of choosing one slot machine over another because there is no prior information.</span></p>
<p>Let’s say we picked slot machine 1 and lost. At this point we still do not have any information about slot 2. Think about which slot machine would you pick during the second try and why? We would pick slot 2 right? This is partly because of probability.</p>
<div class="math notranslate nohighlight">
\[P(\text{success}) = \frac{\text{Number of successful events}}{\text{Total events}}\]</div>
<p>For slot 1 → P = 0</p>
<p>For slot 2 → P = undefined.</p>
<p>Our gut says that somehow undefined is better than 0 and we want to explore the other slot machine, although you cannot compare them numerically.</p>
<p>Let’s say you picked slot 2 and won. Which one do we play next? We would pick slot 2 as <span class="math notranslate nohighlight">\(P(2) =1\)</span> and <span class="math notranslate nohighlight">\(P(0) = 0\)</span>. <span class = 'nital'>In terms of probability, these estimates are what we call Maximum likelihood estimates and the process of picking the slot machine with maximum likelihood is called ‘Greedy approach’.</span></p>
<p>Is there something wrong with this method of choosing? Consider we played slot machine 2 ten times and won only once, there would be more disagreement about which machine to choose next and something tells us to choose slot 1 instead of quantitative proof that slot 2 is better. Is there a way to algorithmically model this intuition?</p>
</div>
<div class="section" id="statistical-approach-towards-choosing-slot-machines">
<h2>Statistical approach towards choosing slot machines.<a class="headerlink" href="#statistical-approach-towards-choosing-slot-machines" title="Permalink to this headline">¶</a></h2>
<p>Statisticians would say that the above approach is totally wrong. One would say that the ‘correct’ way is to decide ‘How much data to collect before walking into the casino?’, the statistical power of the experiment and the effect size. However, one major question here is that ‘How do you know the effect size without playing the machines?’</p>
<p>Let’s say you decided to play each machine 10000 times and slot machine 1 → 3 rewards and slot machine 2 → 4000 times, but you cannot stop the experiment and play each slot 10,000 times. This would result in the loss of several coins just to understand the reward approximation by slot machines.</p>
</div>
<div class="section" id="adaptation">
<h2>Adaptation<a class="headerlink" href="#adaptation" title="Permalink to this headline">¶</a></h2>
<p>Thus, we require a new method that can adapt based on recent findings and estimates of probability of slot machines. This the exact intuition that we initially had while choosing slot machines. In this section, we shall model the intuition algorithmically.</p>
<p>We have two opposing forces (kind of):</p>
<ol class="simple">
<li><p>To be a good statistician and collect as much data as possible (exploration)</p></li>
<li><p>Pick the machine with highest probability estimate (exploitation)</p></li>
</ol>
<p>As these two forces oppose each other, we call this as the explore-exploit dilemma.</p>
<p>Rest of the section deals about ways to overcome this explore-exploit dilemma using several algorithms including,</p>
<ol class="simple">
<li><p>Epsilon-greedy method</p></li>
<li><p>Optimistic Initial Values</p></li>
<li><p>UCB1</p></li>
<li><p>Thompson Sampling (Bayesian Bandit)</p></li>
</ol>
<p>These methods can be used in A/B testing. These methods are adaptive.</p>
</div>
<div class="section" id="applications-of-explore-exploit-dilemma">
<h2>Applications of Explore-Exploit Dilemma<a class="headerlink" href="#applications-of-explore-exploit-dilemma" title="Permalink to this headline">¶</a></h2>
<p>The concept of comparing things to see which one is better can be applied to any business. Let’s say a mobile manufacturing company made a brand new phone and their designer has created two ads and wants to decide on which ad is better. You have to choose the ad which the user is most likely to click and buy your phone. One way to decide is using “Click-Through Rate” of each ad.</p>
<div class="math notranslate nohighlight">
\[\text{CTR} = \frac{\text{Number of clicks}}{\text{Total number of impressions}}\]</div>
<p>Doing an experiment seems to be the best choice to decide which ad to choose, but as per probability ‘to reach absolute precision is to collect infinite samples.’ However, if I show the worse advertisement 1 million times, that means I have wasted 1 million impressions to get a sub-optimal CTR.</p>
<p><span class = 'hital'>In other words, my desire to show the best advertisement always is fundamentally at odds with my desire to find accurate CTRs for each advertisement.</span></p>
<p>Numerous online businesses have advertisements at their core and these concepts can be applied to almost all of such businesses. One need not even be an established business to apply these techniques. Assuming you have traffic and one or more choices to choose from, the concept of Multi-Arm Bandit (MAB) can be applied to many applications including the following:</p>
<ul class="simple">
<li><p>Compare viewing time on old design vs new design</p></li>
<li><p>Is “Buy Now” button better at the top or bottom of sales pages?</p></li>
<li><p>Which “price ending” leads to the most conversions? $20 vs $19.99 vs $19.98?</p></li>
</ul>
<p>For practice both CTR and conversion rate are calculate similarly because they are a generic measure of “success rate”.</p>
<p>Another example is the news feed recommendation for apps like Facebook, New York Times. When people click on feed they see more ads, with more ads, more products can be bought and hence more conversion rate. This is the cycle of life ;)</p>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>This section is to introduce you to the explore-exploit dilemma and how its applications are used in almost all business. These concepts can be used to decide between items such as ‘which headline?’, ‘which post?’, ‘which ad?’ and so on.</p>
</div>
<div class="toctree-wrapper compound">
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "EssentialAI/rl",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="C1_prob.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Introduction to Probability</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="epsilon-greedy.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">[4.1] Epsilon-Greedy</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Naresh Kumar<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>